# 明細書チェックくん

特許明細書案（`.docx`）を解析し、審査基準や特許法に基づく基本的な観点からチェックを行うコマンドラインツールです。誤字脱字の疑い、重要セクションの抜け漏れ、請求項番号の整合性などを抽出し、必要に応じて自動修正を適用した改訂版ドキュメントと Markdown レポートを生成します。

## 主な機能

- Word (`.docx`) ファイルを独自パーサーで読み込み、Python 標準ライブラリのみで解析
- 実施可能要件・サポート要件に関わる記載の抜け漏れなど、法的観点からのヒューリスティックチェック
- 請求項番号や参照表記などの形式的な不整合検出
- プレースホルダーや誤記が疑われる表現の抽出
- チェック結果ごとに修正案を提示し、選択したものを自動で適用
- 適用結果を Markdown レポートと修正済み `.docx` として出力

## 必要条件

- Python 3.10 以上
- 追加の外部ライブラリは不要です（Python 標準ライブラリのみで動作します）

## セットアップ

1. リポジトリをクローンします。
   ```bash
   git clone <this-repository-url>
   cd <this-repository-name>
   ```
2. 必要に応じて仮想環境を用意し、アクティベートします。
   ```bash
   python -m venv .venv
   source .venv/bin/activate  # Windows は `.venv\\Scripts\\activate`
   ```
3. 依存関係はありませんが、ツールの互換性維持のため `requirements.txt` を空でも維持しています。

## 環境変数ファイル

- `.env.example` を `.env` にコピーし、将来的に導入する外部 API 等の認証情報を設定できます。
  現時点では必須の API キーはありません。

  ```bash
  cp .env.example .env
  # 必要に応じてキーを編集
  ```

- `.gitignore` で `.env` は無視されるため、個人の資格情報が誤ってコミットされることを防げます。

## 使い方

```bash
python 明細書チェックくん.py <入力ファイル.docx>
```

### 主なオプション

| オプション | 説明 |
|------------|------|
| `--output` | 自動修正を適用した `.docx` の出力先を指定（デフォルトは `<元ファイル名>_revised.docx`） |
| `--report` | チェック結果レポート（Markdown）の出力先を指定（デフォルトは `<元ファイル名>_check_report.md`） |
| `--non-interactive` | 対話操作をスキップし、自動修正を適用せずにレポートのみ生成 |

オプションを省略すると、対話形式で指摘ごとに修正の有無や備考を入力できます。選択した自動修正は解析中に `DocxDocument` へ反映され、最終的な `.docx` に書き出されます。

## 出力物

- `*_revised.docx` — 自動修正を適用した明細書案（修正を一切選ばなかった場合は作成されません）。
- `*_check_report.md` — 指摘内容、重要度、修正状況、備考などをまとめた Markdown レポート。

## プロジェクト構成

```
.
├── 明細書チェックくん.py     # メインの CLI ツール
├── README.md                 # プロジェクト概要と利用手順
├── requirements.txt          # 依存関係（標準ライブラリのみ）
├── .env.example              # 環境変数設定テンプレート
└── .gitignore                # 不要ファイルの除外設定
```

## 開発・拡張にあたって

- チェックロジックは `run_checks` 関数とその周辺のユーティリティ関数にまとまっているため、追加ルールを組み込みやすい構成です。
- 自動修正処理は `AutoFix` オブジェクトとして定義され、`review_findings` の対話フローから呼び出されます。独自の修正ロジックを追加する場合はこの仕組みを利用してください。
- 文書の読み込みと書き出しは `DocxDocument` クラスが担当します。高度な書式保持や段落構造の変更が必要な場合は、適宜機能を拡張してください。

## ライセンス

- ライセンスを設定する場合は、このセクションを更新してください。
